{"ast":null,"code":"import _regeneratorRuntime from\"D:/js/resturent/connect/spoffy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/js/resturent/connect/spoffy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/js/resturent/connect/spoffy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"D:/js/resturent/connect/spoffy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21,_templateObject22,_templateObject23,_templateObject24,_templateObject25,_templateObject26,_templateObject27,_templateObject28;import styled from\"styled-components\";import Announcement from\"../components/Announcement\";import Footer from\"../components/Footer\";import Navbar from\"../components/Navbar\";import{mobile}from\"../responsive\";import{useDispatch,useSelector}from\"react-redux\";import StripeCheckout from\"react-stripe-checkout\";import{useState,useEffect}from\"react\";import{publicRequest,userRequest}from\"../requestMethod\";import{useHistory}from\"react-router\";import _ from\"lodash\";import{addFood}from\"../redux/foodRedux\";import Remove from\"@mui/icons-material/Remove\";import{addProduct,updateProduct}from\"../redux/cartRedux\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var KEY=process.env.REACT_APP_STRIPE;var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\"])));var Wrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n  \",\"\\n\"])),mobile({padding:\"10px\"}));var Title=styled.h1(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  font-weight: 300;\\n  text-align: center;\\n\"])));var Top=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 20px;\\n\"])));var TopButton=styled.button(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  padding: 10px;\\n  font-weight: 600;\\n  cursor: pointer;\\n  border: \",\";\\n  background-color: \",\";\\n  color: \",\";\\n\"])),function(props){return props.type===\"filled\"&&\"none\";},function(props){return props.type===\"filled\"?\"black\":\"transparent\";},function(props){return props.type===\"filled\"&&\"white\";});var TopTexts=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  \",\"\\n\"])),mobile({display:\"none\"}));var TopText=styled.h3(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  text-decoration: underline;\\n  cursor: pointer;\\n  margin: 0px 10px;\\n\"])));var Bottom=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  \",\"\\n\"])),mobile({flexDirection:\"column\"}));var Info=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  flex: 3;\\n\"])));var Product=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  \",\"\\n  margin-bottom:20px;\\n\"])),mobile({flexDirection:\"column\"}));var ProductDetail=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  flex: 2;\\n  display: flex;\\n\"])));var Image=styled.img(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  width: 200px;\\n\"])));var Details=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-around;\\n\"])));var ProductName=styled.p(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\"])));var ProductId=styled.p(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\"])));var ProductColor=styled.div(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  width: 20px;\\n  height: 20px;\\n  border-radius: 50%;\\n  background-color: \",\";\\n\"])),function(props){return props.color;});var ProductSize=styled.p(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\"])));var PriceDetail=styled.div(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: center;\\n\"])));var ProductAmountContainer=styled.div(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  margin-bottom: 20px;\\n\"])));var ProductAmount=styled.div(_templateObject20||(_templateObject20=_taggedTemplateLiteral([\"\\n  font-size: 24px;\\n  margin: 5px;\\n  \",\"\\n\"])),mobile({margin:\"5px 15px\"}));var ProductPrice=styled.div(_templateObject21||(_templateObject21=_taggedTemplateLiteral([\"\\n  font-size: 30px;\\n  font-weight: 200;\\n  \",\"\\n\"])),mobile({marginBottom:\"20px\"}));var Hr=styled.hr(_templateObject22||(_templateObject22=_taggedTemplateLiteral([\"\\n  background-color: #eee;\\n  border: none;\\n  height: 1px;\\n\"])));var Summary=styled.div(_templateObject23||(_templateObject23=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  border: 0.5px solid lightgray;\\n  border-radius: 10px;\\n  padding: 20px;\\n  height: 50vh;\\n\"])));var SummaryTitle=styled.h1(_templateObject24||(_templateObject24=_taggedTemplateLiteral([\"\\n  font-weight: 200;\\n\"])));var SummaryItem=styled.div(_templateObject25||(_templateObject25=_taggedTemplateLiteral([\"\\n  margin: 30px 0px;\\n  display: flex;\\n  justify-content: space-between;\\n  font-weight: \",\";\\n  font-size: \",\";\\n\"])),function(props){return props.type===\"total\"&&\"500\";},function(props){return props.type===\"total\"&&\"24px\";});var SummaryItemText=styled.p(_templateObject26||(_templateObject26=_taggedTemplateLiteral([\"\"])));var SummaryItemPrice=styled.p(_templateObject27||(_templateObject27=_taggedTemplateLiteral([\"\"])));var Button=styled.button(_templateObject28||(_templateObject28=_taggedTemplateLiteral([\"\\n  width: 60%;\\n  padding: 5px;\\n  background-color: black;\\n  color: white;\\n  font-weight: 600;\\n  align-items:center;\\n  display:flex;\\n\"])));export var Cart=function Cart(){var dispatch=useDispatch();var user=useSelector(function(state){return state.user.currentUser;});var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),productCart=_useState2[0],setProductCart=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),stripeToken=_useState4[0],setStripeToken=_useState4[1];var onToken=function onToken(token){setStripeToken(token);};var cart=useSelector(function(state){return state.food;});var p=useSelector(function(state){return state.cart.products;});useEffect(function(){updateProductIncart();},[]);function updateProductIncart(e){// e.preventDefault();\nsetProductCart(p);}console.log(productCart);useEffect(function(){var makeRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return userRequest.post(\"/checkout/payment\",{tokenId:stripeToken.id,amount:cart.total*100});case 3:res=_context.sent;history.push(\"/success\",{data:res.data});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function makeRequest(){return _ref.apply(this,arguments);};}();stripeToken&&makeRequest();},[stripeToken,cart.total,history]);var onClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var newOrder;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;newOrder={userId:user._id,products:cart.products,amount:cart.total,address:user.address?user.address:\"bankra\"};// console.log(newOrder)\n_context2.next=4;return publicRequest.post(\"/orders/\",newOrder);case 4:_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function onClick(){return _ref2.apply(this,arguments);};}();var handleRemovecart=function handleRemovecart(id){var newcart=p.filter(function(c){return c._id!==id;});console.log(newcart);dispatch(updateProduct(newcart));updateProductIncart();};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(Announcement,{}),/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsx(Title,{children:\"YOUR BAG\"}),/*#__PURE__*/_jsxs(Top,{children:[/*#__PURE__*/_jsx(Link,{to:\"/\"}),/*#__PURE__*/_jsx(TopButton,{children:\"CONTINUE SHOPPING\"}),/*#__PURE__*/_jsxs(TopTexts,{children:[/*#__PURE__*/_jsxs(TopText,{children:[\"Shopping Bag(\",cart.foods.length,\")\"]}),/*#__PURE__*/_jsx(TopText,{children:\"Your Wishlist (0)\"})]}),/*#__PURE__*/_jsx(TopButton,{type:\"filled\",onClick:onClick,children:\"MY ORDERS\"})]}),/*#__PURE__*/_jsxs(Bottom,{children:[/*#__PURE__*/_jsxs(Info,{children:[productCart===null||productCart===void 0?void 0:productCart.map(function(product){return/*#__PURE__*/_jsxs(Product,{children:[/*#__PURE__*/_jsxs(ProductDetail,{children:[/*#__PURE__*/_jsx(Image,{src:product===null||product===void 0?void 0:product.img}),/*#__PURE__*/_jsxs(Details,{children:[/*#__PURE__*/_jsxs(ProductName,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Product:\"}),\" \",product===null||product===void 0?void 0:product.cat]}),/*#__PURE__*/_jsxs(ProductId,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"ID:\"}),\" \",product===null||product===void 0?void 0:product._id]}),/*#__PURE__*/_jsxs(ProductSize,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Details:\"}),\" \",product===null||product===void 0?void 0:product.type]}),/*#__PURE__*/_jsxs(Button,{onClick:function onClick(){return handleRemovecart(product._id);},children:[/*#__PURE__*/_jsx(Remove,{}),\"Remove\"]})]})]}),/*#__PURE__*/_jsxs(PriceDetail,{children:[/*#__PURE__*/_jsx(ProductAmountContainer,{children:/*#__PURE__*/_jsx(ProductAmount,{children:\"\".concat(product.quantity,\"*\").concat(product.price)})}),/*#__PURE__*/_jsx(ProductPrice,{children:product.total})]})]});}),/*#__PURE__*/_jsx(Hr,{})]}),/*#__PURE__*/_jsxs(Summary,{children:[/*#__PURE__*/_jsx(SummaryTitle,{children:\"ORDER SUMMARY\"}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryItemText,{children:\"Subtotal\"}),/*#__PURE__*/_jsxs(SummaryItemPrice,{children:[\"\\u20B9 \",cart===null||cart===void 0?void 0:cart.totalPrice]})]}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryItemText,{children:\"Estimated Shipping\"}),/*#__PURE__*/_jsx(SummaryItemPrice,{children:\"\\u20B9 59.0\"})]}),/*#__PURE__*/_jsxs(SummaryItem,{children:[/*#__PURE__*/_jsx(SummaryItemText,{children:\"Shipping Discount\"}),/*#__PURE__*/_jsx(SummaryItemPrice,{children:\"\\u20B9 59.0\"})]}),/*#__PURE__*/_jsxs(SummaryItem,{type:\"total\",children:[/*#__PURE__*/_jsx(SummaryItemText,{children:\"Total\"}),/*#__PURE__*/_jsxs(SummaryItemPrice,{children:[\"\\u20B9 \",cart.totalPrice]})]}),/*#__PURE__*/_jsx(StripeCheckout,{name:\"SPOFFY\",billingAddress:true,shippingAddress:true,description:\"your total is rs\".concat(cart.total),amount:cart.total*100,token:onToken,stripeKey:KEY,children:/*#__PURE__*/_jsx(Button,{children:\"CHECKOUT NOW\"})})]})]})]}),/*#__PURE__*/_jsx(Footer,{})]});};","map":{"version":3,"sources":["D:/js/resturent/connect/spoffy/src/pages/Cart.jsx"],"names":["styled","Announcement","Footer","Navbar","mobile","useDispatch","useSelector","StripeCheckout","useState","useEffect","publicRequest","userRequest","useHistory","_","addFood","Remove","addProduct","updateProduct","Link","KEY","process","env","REACT_APP_STRIPE","Container","div","Wrapper","padding","Title","h1","Top","TopButton","button","props","type","TopTexts","display","TopText","h3","Bottom","flexDirection","Info","Product","ProductDetail","Image","img","Details","ProductName","p","ProductId","ProductColor","color","ProductSize","PriceDetail","ProductAmountContainer","ProductAmount","margin","ProductPrice","marginBottom","Hr","hr","Summary","SummaryTitle","SummaryItem","SummaryItemText","SummaryItemPrice","Button","Cart","dispatch","user","state","currentUser","history","productCart","setProductCart","stripeToken","setStripeToken","onToken","token","cart","food","products","updateProductIncart","e","console","log","makeRequest","post","tokenId","id","amount","total","res","push","data","onClick","newOrder","userId","_id","address","handleRemovecart","newcart","filter","c","foods","length","map","product","cat","quantity","price","totalPrice"],"mappings":"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","sourcesContent":["\r\nimport styled from \"styled-components\";\r\nimport Announcement from \"../components/Announcement\";\r\nimport Footer from \"../components/Footer\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport { mobile } from \"../responsive\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport StripeCheckout from \"react-stripe-checkout\"\r\nimport { useState, useEffect } from \"react\";\r\nimport { publicRequest, userRequest } from \"../requestMethod\";\r\nimport { useHistory } from \"react-router\";\r\nimport _ from \"lodash\"\r\nimport { addFood } from \"../redux/foodRedux\";\r\nimport Remove from \"@mui/icons-material/Remove\";\r\nimport { addProduct, updateProduct } from \"../redux/cartRedux\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst KEY = process.env.REACT_APP_STRIPE;\r\n\r\nconst Container = styled.div``;\r\n\r\nconst Wrapper = styled.div`\r\n  padding: 20px;\r\n  ${mobile({ padding: \"10px\" })}\r\n`;\r\n\r\nconst Title = styled.h1`\r\n  font-weight: 300;\r\n  text-align: center;\r\n`;\r\n\r\nconst Top = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 20px;\r\n`;\r\n\r\nconst TopButton = styled.button`\r\n  padding: 10px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  border: ${(props) => props.type === \"filled\" && \"none\"};\r\n  background-color: ${(props) =>\r\n    props.type === \"filled\" ? \"black\" : \"transparent\"};\r\n  color: ${(props) => props.type === \"filled\" && \"white\"};\r\n`;\r\n\r\nconst TopTexts = styled.div`\r\n  ${mobile({ display: \"none\" })}\r\n`;\r\nconst TopText = styled.h3`\r\n  text-decoration: underline;\r\n  cursor: pointer;\r\n  margin: 0px 10px;\r\n`;\r\n\r\nconst Bottom = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  ${mobile({ flexDirection: \"column\" })}\r\n`;\r\n\r\nconst Info = styled.div`\r\n  flex: 3;\r\n`;\r\n\r\nconst Product = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  ${mobile({ flexDirection: \"column\" })}\r\n  margin-bottom:20px;\r\n`;\r\n\r\nconst ProductDetail = styled.div`\r\n  flex: 2;\r\n  display: flex;\r\n`;\r\n\r\nconst Image = styled.img`\r\n  width: 200px;\r\n`;\r\n\r\nconst Details = styled.div`\r\n  padding: 20px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-around;\r\n`;\r\n\r\nconst ProductName = styled.p``;\r\n\r\nconst ProductId = styled.p``;\r\n\r\nconst ProductColor = styled.div`\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 50%;\r\n  background-color: ${(props) => props.color};\r\n`;\r\n\r\nconst ProductSize = styled.p``;\r\n\r\nconst PriceDetail = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst ProductAmountContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n`;\r\n\r\nconst ProductAmount = styled.div`\r\n  font-size: 24px;\r\n  margin: 5px;\r\n  ${mobile({ margin: \"5px 15px\" })}\r\n`;\r\n\r\nconst ProductPrice = styled.div`\r\n  font-size: 30px;\r\n  font-weight: 200;\r\n  ${mobile({ marginBottom: \"20px\" })}\r\n`;\r\n\r\nconst Hr = styled.hr`\r\n  background-color: #eee;\r\n  border: none;\r\n  height: 1px;\r\n`;\r\n\r\nconst Summary = styled.div`\r\n  flex: 1;\r\n  border: 0.5px solid lightgray;\r\n  border-radius: 10px;\r\n  padding: 20px;\r\n  height: 50vh;\r\n`;\r\n\r\nconst SummaryTitle = styled.h1`\r\n  font-weight: 200;\r\n`;\r\n\r\nconst SummaryItem = styled.div`\r\n  margin: 30px 0px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-weight: ${(props) => props.type === \"total\" && \"500\"};\r\n  font-size: ${(props) => props.type === \"total\" && \"24px\"};\r\n`;\r\n\r\nconst SummaryItemText = styled.p``;\r\n\r\nconst SummaryItemPrice = styled.p``;\r\n\r\nconst Button = styled.button`\r\n  width: 60%;\r\n  padding: 5px;\r\n  background-color: black;\r\n  color: white;\r\n  font-weight: 600;\r\n  align-items:center;\r\n  display:flex;\r\n`;\r\n\r\nexport const Cart = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const user = useSelector(state => state.user.currentUser)\r\n  const history = useHistory();\r\n  const [productCart, setProductCart] = useState([])\r\n  const [stripeToken, setStripeToken] = useState(null)\r\n  const onToken = (token) => {\r\n    setStripeToken(token);\r\n  }\r\n\r\n  const cart = useSelector(state => state.food)\r\n  const p = useSelector(state => state.cart.products);\r\n\r\n  useEffect(() => {\r\n    updateProductIncart();\r\n  }, [])\r\n\r\n  function updateProductIncart(e) {\r\n    // e.preventDefault();\r\n    setProductCart(p);\r\n  }\r\n\r\n\r\n  console.log(productCart)\r\n\r\n  useEffect(() => {\r\n    const makeRequest = async () => {\r\n      try {\r\n        const res = await userRequest.post(\"/checkout/payment\", {\r\n          tokenId: stripeToken.id,\r\n          amount: cart.total * 100,\r\n\r\n        });\r\n\r\n        history.push(\"/success\", { data: res.data });\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    }; stripeToken && makeRequest();\r\n  }, [stripeToken, cart.total, history]);\r\n\r\n  const onClick = async () => {\r\n    try {\r\n      const newOrder = {\r\n        userId: user._id,\r\n        products: cart.products,\r\n        amount: cart.total,\r\n        address: user.address ? user.address : \"bankra\",\r\n\r\n      }\r\n      // console.log(newOrder)\r\n      await publicRequest.post(\"/orders/\", newOrder);\r\n    } catch (err) {\r\n      console.log(err)\r\n    }\r\n  }\r\n\r\n  const handleRemovecart = (id) => {\r\n    const newcart = p.filter((c) => c._id !== id);\r\n    console.log(newcart)\r\n    dispatch(updateProduct(newcart));\r\n    updateProductIncart();\r\n  }\r\n\r\n\r\n  return (\r\n    <Container>\r\n      <Navbar />\r\n      <Announcement />\r\n      <Wrapper>\r\n        <Title>YOUR BAG</Title>\r\n        <Top>\r\n          <Link to=\"/\"></Link><TopButton>CONTINUE SHOPPING</TopButton>\r\n          <TopTexts>\r\n            <TopText>Shopping Bag({cart.foods.length})</TopText>\r\n            <TopText>Your Wishlist (0)</TopText>\r\n          </TopTexts>\r\n          <TopButton type=\"filled\" onClick={onClick}>MY ORDERS</TopButton>\r\n        </Top>\r\n        <Bottom>\r\n          <Info>\r\n            {productCart?.map((product) => (\r\n\r\n              <Product>\r\n                <ProductDetail>\r\n                  <Image src={product?.img} />\r\n                  <Details>\r\n                    <ProductName>\r\n                      <b>Product:</b> {product?.cat}\r\n                    </ProductName>\r\n                    <ProductId>\r\n                      <b>ID:</b> {product?._id}\r\n                    </ProductId>\r\n                    <ProductSize>\r\n                      <b>Details:</b> {product?.type}\r\n                    </ProductSize>\r\n                    <Button onClick={() => handleRemovecart(product._id)}><Remove />Remove</Button>\r\n                  </Details>\r\n                </ProductDetail>\r\n                <PriceDetail>\r\n                  <ProductAmountContainer>\r\n                    <ProductAmount>{`${product.quantity}*${product.price}`}</ProductAmount>\r\n                  </ProductAmountContainer>\r\n                  <ProductPrice>{product.total}</ProductPrice>\r\n                </PriceDetail>\r\n              </Product>\r\n            ))}\r\n            <Hr />\r\n\r\n          </Info>\r\n          <Summary>\r\n            <SummaryTitle>ORDER SUMMARY</SummaryTitle>\r\n            <SummaryItem>\r\n              <SummaryItemText>Subtotal</SummaryItemText>\r\n              <SummaryItemPrice>₹ {cart?.totalPrice}</SummaryItemPrice>\r\n            </SummaryItem>\r\n            <SummaryItem>\r\n              <SummaryItemText>Estimated Shipping</SummaryItemText>\r\n              <SummaryItemPrice>₹ 59.0</SummaryItemPrice>\r\n            </SummaryItem>\r\n            <SummaryItem>\r\n              <SummaryItemText>Shipping Discount</SummaryItemText>\r\n              <SummaryItemPrice>₹ 59.0</SummaryItemPrice>\r\n            </SummaryItem>\r\n            <SummaryItem type=\"total\">\r\n              <SummaryItemText>Total</SummaryItemText>\r\n              <SummaryItemPrice>₹ {cart.totalPrice}</SummaryItemPrice>\r\n            </SummaryItem>\r\n            <StripeCheckout\r\n\r\n              name=\"SPOFFY\"\r\n              billingAddress\r\n              shippingAddress\r\n              description={`your total is rs${cart.total}`}\r\n              amount={cart.total * 100}\r\n              token={onToken}\r\n              stripeKey={KEY}\r\n            >\r\n              <Button>CHECKOUT NOW</Button>\r\n            </StripeCheckout>\r\n          </Summary>\r\n        </Bottom>\r\n      </Wrapper>\r\n      <Footer />\r\n    </Container>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}